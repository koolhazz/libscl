#!/bin/sh


# ******************************************************************************
#
# ******************************************************************************

TSTDIR=`pwd`
SRCDIR=`expr ${TSTDIR} : "\(.*\)/test"`/src

echo "Source Directory is \"${SRCDIR}\"."


# ******************************************************************************
#
# ******************************************************************************

if [ "`uname -s`" = "SunOS" -a "`uname -r | cut -c 1`" = "5" ]; then
	OSTYPE="SOLARIS"
fi

if [ "`uname -s`" = "Linux" ]; then
	OSTYPE="LINUX"
fi


# ******************************************************************************
#
# ******************************************************************************

echo "gcc -g -c tmain.c"
gcc -g -c tmain.c

for d in t*; do
	[ ! -d ${d} ] && continue
	cd ${d}
	for f in t*[0-9]*.c; do
		[ ! -f ${f} ] && continue
		e=`expr ${f} : "\(.*\)\.c"`
		echo "GCC ${f}"
		gcc -g -D${OSTYPE} -D_unix \
			-I${TSTDIR} -I${SRCDIR} \
			${TSTDIR}/tmain.o ${f} ${SRCDIR}/libscl.a -o ${e}
		mv ${e} ..
	done
	cd ..
done

rm tmain.o


# ******************************************************************************
#
# ******************************************************************************

unset -v d
unset -v e
unset -v f

unset -v TSTDIR
unset -v SRCDIR
unset -v OSTYPE


# ******************************************************************************
#
# ******************************************************************************

exit 0
